<!DOCTYPE html>
<html lang="en">

<head>
    <style>
        body { margin: 0; }
    </style>
    <script src="//unpkg.com/three"></script>
    <script src="//unpkg.com/3d-force-graph"></script>
</head>

<body>
    <div id="3d-graph"></div>

    <script>
        const elem = document.getElementById('3d-graph');

        const Graph = ForceGraph3D()
        (elem)
            .jsonUrl('../datasets/miserables.json')
            .nodeLabel('id')
            .nodeAutoColorBy('group')
            .onNodeClick(node => {
                // Aim at node from outside it
                const distance = 40;
                const distRatio = 1 + distance / Math.hypot(node.x, node.y, node.z);

                const newPos = node.x || node.y || node.z
                    ? { x: node.x * distRatio, y: node.y * distRatio, z: node.z * distRatio }
                    : { x: 0, y: 0, z: distance };

                Graph.cameraPosition(
                    newPos,
                    node,
                    3000
                );
            })
            .onLinkClick(link => {
                  // Check if the clicked link is the one you want
                  const sourceId = link.source.id || link.source; // In case the source is an object
                  const targetId = link.target.id || link.target; // In case the target is an object

                  if (sourceId === "FailureTalk" && targetId === "Platform") {
                      // Display the specified image in the current window
                      const imgElement = document.createElement('img');
                      imgElement.src = 'https://cdn.imweb.me/thumbnail/20221111/ab11f0932cf44.jpg';
                      imgElement.style.maxWidth = '80%'; // Adjust as needed
                      imgElement.style.maxHeight = '80%'; // Adjust as needed
                      imgElement.style.position = 'fixed';
                      imgElement.style.top = '50%';
                      imgElement.style.left = '50%';
                      imgElement.style.transform = 'translate(-50%, -50%)';
                      imgElement.style.zIndex = '9999';
                      imgElement.addEventListener('click', () => {
                          imgElement.remove();
                      });
                      document.body.appendChild(imgElement);
                  }
              });
    </script>
</body>

</html>
